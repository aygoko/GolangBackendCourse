**Задание: Реализация аутентификации на основе сессий**

---

### **Цель задания**  
Добавить аутентификацию в HTTP-сервис для защиты ресурсов. Пользователи должны регистрироваться, входить в систему и получать доступ к функционалу через токены сессий.

---

### **Требования к функциональности**  
1. **API-интерфейс аутентификации:**  
   - **POST /register**  
     - **Body:** JSON `{ "username": "string", "password": "string" }`.  
     - **Ответ:** `201 Created` (если пользователь успешно зарегистрирован).  
     - **Ограничения:**  
       - Логин должен быть уникальным.  
       - Пароль хранится в зашифрованном виде (например, через `bcrypt`).  

   - **POST /login**  
     - **Body:** JSON `{ "username": "string", "password": "string" }`.  
     - **Ответ:**  
       - `200 OK` с токеном в формате `{ "token": "string" }`, если аутентификация успешна.  
       - `401 Unauthorized` при неверном логине/пароле.  
     - **Логика:**  
       - Генерация уникального `session_id` (например, через `uuid`).  
       - Сохранение сессии в хранилище.  

   - **Защита всех эндпоинтов:**  
     - Все запросы (кроме `/register` и `/login`) требуют токена в заголовке `Authorization: Bearer {token}`.  
     - Отсутствие/некорректный токен → `401 Unauthorized`.  

---

### **Модели данных**  
1. **User**  
   ```go  
   type User struct {  
       ID       string `json:"id"`       // UUIDv4  
       Username string `json:"username"`  
       Password string `json:"password"` // Хэш пароля  
   }  
   ```  

2. **Session**  
   ```go  
   type Session struct {  
       UserID    string `json:"user_id"`    // Связь с User.ID  
       SessionID string `json:"session_id"` // UUIDv4  
   }  
   ```  

---


### **Документация Swagger**  

Обновите комментарии для генерации Swagger-документации:  

---

### Тестирование

1. **Юнит-тесты:**  
   - Проверка регистрации с дубликатом логина → `400 Bad Request`.  
   - Проверка входа с неверным паролем → `401 Unauthorized`.  
   - Проверка middleware: запрос без токена → `401 Unauthorized`.  

2. **Интеграционные тесты:**  
   - Полный цикл регистрации → вход → получение токена → доступ к защищенным эндпоинтам.  

---

### **Дополнительные требования**  
- **Стиль кода:** Соблюдайте чистоту кода (например, `go fmt`, `go vet`).  
- **Ошибка 404:** Добавьте обработку несуществующих эндпоинтов (например, `fiber.NotFound`).  
- **Логирование:** Добавьте базовое логирование (например, через `logrus`).  

---
### Материалы

https://astaxie.gitbooks.io/build-web-application-with-golang/content/en/06.2.html - здесь можно посмотреть, как можно работать с сессиями

---

**Срок сдачи:**  09.04.25
Отправьте pull request в репозиторий курса.  

